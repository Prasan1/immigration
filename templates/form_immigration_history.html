<!DOCTYPE html>
<html lang="en">
<head>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@600;700;800&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immigration History Worksheet</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>

        .navbar {
            background: white !important;
            border-bottom: 2px solid transparent;
            border-image: linear-gradient(to right, #b45309, #0f766e) 1;
            box-shadow: 0 4px 12px rgba(15, 23, 42, 0.08);
        }

        .navbar-brand {
            font-family: 'Fraunces', Georgia, serif;
            font-weight: 800;
            color: #0f172a !important;
        }

        .navbar .nav-link {
            color: #475569 !important;
            font-weight: 600;
            border-radius: 8px;
            padding: 0.5rem 1rem !important;
        }

        .navbar .nav-link:hover {
            color: #b45309 !important;
            background: rgba(180, 83, 9, 0.12);
        }

        .navbar-toggler {
            border: none;
        }

        .navbar-toggler:focus {
            box-shadow: none;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #000;
        }

        .container {
            max-width: 8.5in;
            margin: 0 auto;
            padding: 0.75in;
        }

        .form-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 20px;
        }

        .form-header h1 {
            font-size: 22px;
            font-weight: bold;
            color: #3498db;
        }

        input[type="text"], input[type="date"], textarea, select {
            border: 1px solid #ccc;
            padding: 8px;
            font-family: 'Arial', sans-serif;
            font-size: 14px;
            width: 100%;
        }

        textarea {
            min-height: 60px;
            resize: vertical;
        }

        .section-title {
            background: #d6eaf8;
            padding: 12px;
            font-weight: bold;
            margin-top: 25px;
            margin-bottom: 15px;
            border-left: 5px solid #3498db;
            color: #1a5490;
        }

        .subsection {
            background: #fcf3cf;
            padding: 10px;
            margin: 15px 0;
            border-left: 3px solid #f39c12;
            font-weight: bold;
        }

        .action-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .btn-action {
            background: #b45309;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(180, 83, 9, 0.3);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
        }

        .btn-action:hover {
            background: #5568d3;
            color: white;
        }

        .btn-home {
            background: #28a745;
        }

        .btn-home:hover {
            background: #218838;
        }

        @media print {
            .action-buttons, .print-hide {
                display: none !important;
            }
            body {
                margin: 0;
                padding: 0;
            }
            .container {
                max-width: 100%;
                padding: 0.5in;
            }
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        table, th, td {
            border: 1px solid #000;
        }

        th, td {
            padding: 8px;
            text-align: left;
        }

        th {
            background: #f0f0f0;
            font-weight: bold;
        }

        .add-row-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .warning-box {
            background: #f1f5f9;
            border-left: 4px solid #94a3b8;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 13px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        /* Share Menu Styles */
        .share-menu {
            position: fixed;
            top: 80px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            z-index: 1001;
            min-width: 250px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        .share-menu.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .share-menu-header {
            padding: 16px 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: #1f2937;
        }

        .share-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        .share-close:hover {
            background: #f3f4f6;
            color: #1f2937;
        }

        .share-options {
            padding: 8px;
        }

        .share-option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #374151;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s;
            gap: 12px;
        }

        .share-option:hover {
            background: #f3f4f6;
            color: #b45309;
        }

        .share-option i {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .share-option .fa-linkedin {
            color: #0077b5;
        }

        .share-option .fa-twitter {
            color: #1da1f2;
        }

        .share-option .fa-facebook {
            color: #1877f2;
        }

        .share-option .fa-whatsapp {
            color: #25d366;
        }

        .share-option .fa-envelope {
            color: #ea4335;
        }

        .share-option .fa-link {
            color: #6b7280;
        }

        @media print {
            .share-menu {
                display: none !important;
            }
        }
    
        @media screen {
            .container {
                padding-top: 24px;
                padding-bottom: 24px;
            }
        }
</style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-light print-hide">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-passport me-2"></i>
                {{ g.branding.site_name }}
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" href="/">
                            <i class="fas fa-home me-1"></i>Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/forms">
                            <i class="fas fa-file-alt me-1"></i>Forms
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/templates">
                            <i class="fas fa-edit me-1"></i>Templates
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/file-compressor">
                            <i class="fas fa-file-archive me-1"></i>Compressor
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/pricing">
                            <i class="fas fa-tags me-1"></i>Pricing
                        </a>
                    </li>
                    {% if user %}
                    <li class="nav-item">
                        <a class="nav-link" href="/dashboard">
                            <i class="fas fa-tachometer-alt me-1"></i>Dashboard
                        </a>
                    </li>
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="/login">
                            <i class="fas fa-sign-in-alt me-1"></i>Sign In
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <div class="action-buttons">
        <a href="/" class="btn-action btn-home">
            <i class="fas fa-home me-2"></i>Home
        </a>
        <button class="btn-action" onclick="window.print()">
            <i class="fas fa-print me-2"></i>Print
        </button>
        <button class="btn-action" onclick="window.print()">
            <i class="fas fa-file-pdf me-2"></i>Save PDF
        </button>
        <button class="btn-action" onclick="toggleShareMenu()">
            <i class="fas fa-share-alt me-2"></i>Share
        </button>
    </div>

    <!-- Share Menu -->
    <div id="shareMenu" class="share-menu">
        <div class="share-menu-header">
            <span>Share this form template</span>
            <button class="share-close" onclick="toggleShareMenu()">&times;</button>
        </div>
        <div class="share-options">
            <a href="#" class="share-option" onclick="shareOn('linkedin')">
                <i class="fab fa-linkedin"></i>
                <span>LinkedIn</span>
            </a>
            <a href="#" class="share-option" onclick="shareOn('twitter')">
                <i class="fab fa-twitter"></i>
                <span>Twitter</span>
            </a>
            <a href="#" class="share-option" onclick="shareOn('facebook')">
                <i class="fab fa-facebook"></i>
                <span>Facebook</span>
            </a>
            <a href="#" class="share-option" onclick="shareOn('whatsapp')">
                <i class="fab fa-whatsapp"></i>
                <span>WhatsApp</span>
            </a>
            <a href="#" class="share-option" onclick="shareOn('email')">
                <i class="fas fa-envelope"></i>
                <span>Email</span>
            </a>
            <a href="#" class="share-option" onclick="copyLink()">
                <i class="fas fa-link"></i>
                <span>Copy Link</span>
            </a>
        </div>
    </div>

    <div class="container">
        <div class="form-header">
            <h1><i class="fas fa-plane-departure me-2"></i>IMMIGRATION HISTORY WORKSHEET</h1>
            <p style="font-size: 14px; margin-top: 10px; color: #666;">
                Complete Chronological Immigration Record
            </p>
        </div>

        <div class="warning-box">
            <strong><i class="fas fa-info-circle me-2"></i>Instructions:</strong>
            Complete this form carefully. List ALL entries, exits, status changes, and visa applications.
            Accuracy is critical - errors can lead to denials or accusations of fraud. When in doubt, include it.
        </div>

        <!-- Personal Information -->
        <div class="section-title"><i class="fas fa-user me-2"></i>I. PERSONAL INFORMATION</div>

        <table>
            <tr>
                <td style="width: 35%;"><strong>Full Legal Name:</strong></td>
                <td><input type="text" name="fullName"></td>
            </tr>
            <tr>
                <td><strong>Other Names Used:</strong></td>
                <td><input type="text" name="otherNames" placeholder="Maiden name, aliases, nicknames"></td>
            </tr>
            <tr>
                <td><strong>Date of Birth:</strong></td>
                <td><input type="date" name="dob"></td>
            </tr>
            <tr>
                <td><strong>Country of Birth:</strong></td>
                <td><input type="text" name="countryOfBirth"></td>
            </tr>
            <tr>
                <td><strong>Country of Citizenship:</strong></td>
                <td><input type="text" name="citizenship"></td>
            </tr>
            <tr>
                <td><strong>A-Number (if any):</strong></td>
                <td><input type="text" name="aNumber" placeholder="A-"></td>
            </tr>
        </table>

        <!-- Current Status -->
        <div class="section-title"><i class="fas fa-id-card me-2"></i>II. CURRENT IMMIGRATION STATUS</div>

        <table>
            <tr>
                <td style="width: 35%;"><strong>Current Status:</strong></td>
                <td>
                    <select name="currentStatus">
                        <option value="">Select...</option>
                        <option value="b2">B-2 Visitor</option>
                        <option value="f1">F-1 Student</option>
                        <option value="h1b">H-1B Worker</option>
                        <option value="l1">L-1 Intracompany Transferee</option>
                        <option value="k1">K-1 Fianc√©(e)</option>
                        <option value="aos">Adjustment of Status Pending</option>
                        <option value="lpr">Lawful Permanent Resident</option>
                        <option value="undocumented">Out of Status / Undocumented</option>
                        <option value="other">Other</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td><strong>Status Expiration Date:</strong></td>
                <td><input type="date" name="statusExpiration"></td>
            </tr>
            <tr>
                <td><strong>USCIS Online Account #:</strong></td>
                <td><input type="text" name="uscisAccount"></td>
            </tr>
        </table>

        <!-- Entry History -->
        <div class="section-title"><i class="fas fa-passport me-2"></i>III. U.S. ENTRY/EXIT HISTORY</div>

        <p style="font-weight: bold; margin-bottom: 10px;">
            List EVERY entry into the United States in chronological order (oldest first):
        </p>

        <table id="entryTable">
            <thead>
                <tr>
                    <th style="width: 15%;">Entry Date</th>
                    <th style="width: 20%;">Port of Entry</th>
                    <th style="width: 15%;">Visa Type</th>
                    <th style="width: 20%;">Purpose</th>
                    <th style="width: 15%;">Exit Date</th>
                    <th style="width: 15%;">I-94 Number</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="date" name="entry1Date"></td>
                    <td><input type="text" name="entry1Port" placeholder="City, State"></td>
                    <td><input type="text" name="entry1Visa" placeholder="B-2, F-1, etc."></td>
                    <td><input type="text" name="entry1Purpose" placeholder="Tourism, Study"></td>
                    <td><input type="date" name="entry1Exit"></td>
                    <td><input type="text" name="entry1I94"></td>
                </tr>
                <tr>
                    <td><input type="date" name="entry2Date"></td>
                    <td><input type="text" name="entry2Port"></td>
                    <td><input type="text" name="entry2Visa"></td>
                    <td><input type="text" name="entry2Purpose"></td>
                    <td><input type="date" name="entry2Exit"></td>
                    <td><input type="text" name="entry2I94"></td>
                </tr>
                <tr>
                    <td><input type="date" name="entry3Date"></td>
                    <td><input type="text" name="entry3Port"></td>
                    <td><input type="text" name="entry3Visa"></td>
                    <td><input type="text" name="entry3Purpose"></td>
                    <td><input type="date" name="entry3Exit"></td>
                    <td><input type="text" name="entry3I94"></td>
                </tr>
            </tbody>
        </table>

        <button class="add-row-btn print-hide" onclick="addEntryRow()">
            <i class="fas fa-plus me-2"></i>Add Another Entry
        </button>

        <!-- Visa Applications -->
        <div class="section-title"><i class="fas fa-file-alt me-2"></i>IV. VISA APPLICATION HISTORY</div>

        <p style="font-weight: bold; margin-bottom: 10px;">
            List ALL visa applications to U.S. Embassies/Consulates (approved or denied):
        </p>

        <table id="visaTable">
            <thead>
                <tr>
                    <th style="width: 20%;">Date Applied</th>
                    <th style="width: 25%;">Embassy/Consulate</th>
                    <th style="width: 15%;">Visa Type</th>
                    <th style="width: 20%;">Result</th>
                    <th style="width: 20%;">Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="date" name="visa1Date"></td>
                    <td><input type="text" name="visa1Embassy" placeholder="e.g., U.S. Embassy London"></td>
                    <td><input type="text" name="visa1Type" placeholder="B-2, F-1"></td>
                    <td>
                        <select name="visa1Result" style="width: 100%;">
                            <option value="">Select...</option>
                            <option value="approved">Approved</option>
                            <option value="denied">Denied</option>
                            <option value="withdrawn">Withdrawn</option>
                        </select>
                    </td>
                    <td><input type="text" name="visa1Notes" placeholder="If denied, reason"></td>
                </tr>
                <tr>
                    <td><input type="date" name="visa2Date"></td>
                    <td><input type="text" name="visa2Embassy"></td>
                    <td><input type="text" name="visa2Type"></td>
                    <td>
                        <select name="visa2Result" style="width: 100%;">
                            <option value="">Select...</option>
                            <option value="approved">Approved</option>
                            <option value="denied">Denied</option>
                            <option value="withdrawn">Withdrawn</option>
                        </select>
                    </td>
                    <td><input type="text" name="visa2Notes"></td>
                </tr>
            </tbody>
        </table>

        <button class="add-row-btn print-hide" onclick="addVisaRow()">
            <i class="fas fa-plus me-2"></i>Add Another Visa Application
        </button>

        <!-- USCIS Petitions/Applications -->
        <div class="section-title"><i class="fas fa-building me-2"></i>V. USCIS PETITIONS & APPLICATIONS</div>

        <p style="font-weight: bold; margin-bottom: 10px;">
            List ALL USCIS petitions/applications filed (approved, denied, pending, withdrawn):
        </p>

        <table id="uscisTable">
            <thead>
                <tr>
                    <th style="width: 20%;">Form Type</th>
                    <th style="width: 20%;">Receipt Number</th>
                    <th style="width: 15%;">Filing Date</th>
                    <th style="width: 15%;">Result</th>
                    <th style="width: 15%;">Decision Date</th>
                    <th style="width: 15%;">Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" name="uscis1Form" placeholder="I-485, I-130, I-140"></td>
                    <td><input type="text" name="uscis1Receipt" placeholder="MSC-21-123-45678"></td>
                    <td><input type="date" name="uscis1FilingDate"></td>
                    <td>
                        <select name="uscis1Result" style="width: 100%;">
                            <option value="">Select...</option>
                            <option value="approved">Approved</option>
                            <option value="denied">Denied</option>
                            <option value="pending">Pending</option>
                            <option value="withdrawn">Withdrawn</option>
                        </select>
                    </td>
                    <td><input type="date" name="uscis1DecisionDate"></td>
                    <td><input type="text" name="uscis1Notes"></td>
                </tr>
                <tr>
                    <td><input type="text" name="uscis2Form"></td>
                    <td><input type="text" name="uscis2Receipt"></td>
                    <td><input type="date" name="uscis2FilingDate"></td>
                    <td>
                        <select name="uscis2Result" style="width: 100%;">
                            <option value="">Select...</option>
                            <option value="approved">Approved</option>
                            <option value="denied">Denied</option>
                            <option value="pending">Pending</option>
                            <option value="withdrawn">Withdrawn</option>
                        </select>
                    </td>
                    <td><input type="date" name="uscis2DecisionDate"></td>
                    <td><input type="text" name="uscis2Notes"></td>
                </tr>
            </tbody>
        </table>

        <button class="add-row-btn print-hide" onclick="addUscisRow()">
            <i class="fas fa-plus me-2"></i>Add Another USCIS Application
        </button>

        <!-- Status Violations -->
        <div class="section-title" style="background: #f8d7da; border-left-color: #e74c3c; color: #721c24;">
            <i class="fas fa-exclamation-triangle me-2"></i>VI. STATUS VIOLATIONS & ISSUES (CRITICAL)
        </div>

        <div style="background: #ffebee; padding: 15px; margin-bottom: 15px; border-left: 4px solid #e74c3c;">
            <strong>BE HONEST:</strong> Hiding violations can lead to permanent bars and fraud accusations. Attorneys can help fix problems, but only if they know about them.
        </div>

        <p><strong>1. Have you EVER overstayed a visa or I-94?</strong></p>
        <label><input type="radio" name="overstay" value="yes"> Yes</label>
        <label><input type="radio" name="overstay" value="no"> No</label>

        <div style="margin-left: 30px; margin-top: 10px;">
            <p>If yes, provide details:</p>
            <textarea name="overstayDetails" placeholder="When? How long? What visa/status? What happened after?"></textarea>
        </div>

        <p style="margin-top: 15px;"><strong>2. Have you EVER worked without authorization in the U.S.?</strong></p>
        <label><input type="radio" name="unauthorizedWork" value="yes"> Yes</label>
        <label><input type="radio" name="unauthorizedWork" value="no"> No</label>

        <div style="margin-left: 30px; margin-top: 10px;">
            <p>If yes, provide details:</p>
            <textarea name="workDetails" placeholder="When? Where? What kind of work? How long?"></textarea>
        </div>

        <p style="margin-top: 15px;"><strong>3. Have you EVER been denied a visa or entry to the U.S.?</strong></p>
        <label><input type="radio" name="denial" value="yes"> Yes</label>
        <label><input type="radio" name="denial" value="no"> No</label>

        <div style="margin-left: 30px; margin-top: 10px;">
            <p>If yes, explain:</p>
            <textarea name="denialDetails" placeholder="When? What type of visa/entry? Reason given?"></textarea>
        </div>

        <p style="margin-top: 15px;"><strong>4. Have you EVER been in removal/deportation proceedings?</strong></p>
        <label><input type="radio" name="removal" value="yes"> Yes</label>
        <label><input type="radio" name="removal" value="no"> No</label>

        <div style="margin-left: 30px; margin-top: 10px;">
            <p>If yes, explain:</p>
            <textarea name="removalDetails" placeholder="When? Where? What court? Outcome?"></textarea>
        </div>

        <p style="margin-top: 15px;"><strong>5. Have you EVER used false documents or made false statements to U.S. immigration?</strong></p>
        <label><input type="radio" name="fraud" value="yes"> Yes</label>
        <label><input type="radio" name="fraud" value="no"> No</label>

        <div style="margin-left: 30px; margin-top: 10px;">
            <p>If yes, explain (THIS IS SERIOUS - consult attorney immediately):</p>
            <textarea name="fraudDetails" placeholder="Full details required"></textarea>
        </div>

        <p style="margin-top: 15px;"><strong>6. Have you EVER been arrested or convicted of any crime?</strong></p>
        <label><input type="radio" name="criminal" value="yes"> Yes</label>
        <label><input type="radio" name="criminal" value="no"> No</label>

        <div style="margin-left: 30px; margin-top: 10px;">
            <p>If yes, list ALL arrests/convictions:</p>
            <textarea name="criminalDetails" placeholder="Date, charge, outcome, sentence. Include expunged/dismissed charges."></textarea>
        </div>

        <!-- Travel Outside U.S. -->
        <div class="section-title"><i class="fas fa-suitcase me-2"></i>VII. INTERNATIONAL TRAVEL (While in U.S.)</div>

        <p><strong>List significant trips outside the U.S. while maintaining status here:</strong></p>
        <textarea name="travel" rows="4" placeholder="Dates, destinations, purpose. Important for continuous residence/physical presence calculations."></textarea>

        <!-- Additional Notes -->
        <div class="section-title"><i class="fas fa-sticky-note me-2"></i>VIII. ADDITIONAL INFORMATION</div>

        <p><strong>Other relevant immigration history:</strong></p>
        <textarea name="additionalInfo" rows="5" placeholder="Any other immigration-related information not covered above. Previous citizenship, name changes, marriages/divorces, children born in U.S., etc."></textarea>

        <!-- Certification -->
        <div style="margin-top: 40px; padding: 15px; border: 2px solid #3498db; background: #ebf5fb;">
            <p style="font-weight: bold;">CERTIFICATION</p>
            <p>I certify that the information provided in this worksheet is true and accurate to the best of my knowledge.</p>

            <div style="margin-top: 20px;">
                <table>
                    <tr>
                        <td><strong>Signature:</strong></td>
                        <td>_____________________________________________</td>
                    </tr>
                    <tr>
                        <td><strong>Print Name:</strong></td>
                        <td><input type="text" name="signatureName"></td>
                    </tr>
                    <tr>
                        <td><strong>Date:</strong></td>
                        <td><input type="date" name="signatureDate"></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <script>
        let entryCount = 3;
        let visaCount = 2;
        let uscisCount = 2;

        function addEntryRow() {
            entryCount++;
            const table = document.getElementById('entryTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();

            newRow.innerHTML = `
                <td><input type="date" name="entry${entryCount}Date"></td>
                <td><input type="text" name="entry${entryCount}Port"></td>
                <td><input type="text" name="entry${entryCount}Visa"></td>
                <td><input type="text" name="entry${entryCount}Purpose"></td>
                <td><input type="date" name="entry${entryCount}Exit"></td>
                <td><input type="text" name="entry${entryCount}I94"></td>
            `;
        }

        function addVisaRow() {
            visaCount++;
            const table = document.getElementById('visaTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();

            newRow.innerHTML = `
                <td><input type="date" name="visa${visaCount}Date"></td>
                <td><input type="text" name="visa${visaCount}Embassy"></td>
                <td><input type="text" name="visa${visaCount}Type"></td>
                <td>
                    <select name="visa${visaCount}Result" style="width: 100%;">
                        <option value="">Select...</option>
                        <option value="approved">Approved</option>
                        <option value="denied">Denied</option>
                        <option value="withdrawn">Withdrawn</option>
                    </select>
                </td>
                <td><input type="text" name="visa${visaCount}Notes"></td>
            `;
        }

        function addUscisRow() {
            uscisCount++;
            const table = document.getElementById('uscisTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();

            newRow.innerHTML = `
                <td><input type="text" name="uscis${uscisCount}Form"></td>
                <td><input type="text" name="uscis${uscisCount}Receipt"></td>
                <td><input type="date" name="uscis${uscisCount}FilingDate"></td>
                <td>
                    <select name="uscis${uscisCount}Result" style="width: 100%;">
                        <option value="">Select...</option>
                        <option value="approved">Approved</option>
                        <option value="denied">Denied</option>
                        <option value="pending">Pending</option>
                        <option value="withdrawn">Withdrawn</option>
                    </select>
                </td>
                <td><input type="date" name="uscis${uscisCount}DecisionDate"></td>
                <td><input type="text" name="uscis${uscisCount}Notes"></td>
            `;
        }

        // Auto-save functionality
        const inputs = document.querySelectorAll('input[name], textarea[name], select[name]');

        inputs.forEach(input => {
            const saved = localStorage.getItem('immighistory_' + input.name);
            if (saved && input.type !== 'radio' && input.type !== 'checkbox') {
                input.value = saved;
            } else if (saved && input.type === 'radio' && input.value === saved) {
                input.checked = true;
            } else if (saved && input.type === 'checkbox') {
                input.checked = saved === 'true';
            }

            input.addEventListener('input', function() {
                if (input.type === 'radio') {
                    localStorage.setItem('immighistory_' + input.name, input.value);
                } else if (input.type === 'checkbox') {
                    localStorage.setItem('immighistory_' + input.name, input.checked);
                } else {
                    localStorage.setItem('immighistory_' + input.name, input.value);
                }
            });

            input.addEventListener('change', function() {
                if (input.type === 'radio' || input.type === 'checkbox') {
                    localStorage.setItem('immighistory_' + input.name, input.type === 'checkbox' ? input.checked : input.value);
                }
            });
        });


        // Share functionality
        function toggleShareMenu() {
            const menu = document.getElementById('shareMenu');
            menu.classList.toggle('active');
        }

        // Close share menu when clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('shareMenu');
            const shareButton = event.target.closest('.btn-action');

            if (!menu.contains(event.target) && !shareButton?.textContent.includes('Share')) {
                menu.classList.remove('active');
            }
        });

        function shareOn(platform) {
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent('Immigration History Worksheet Template');
            const text = encodeURIComponent('Check out this helpful Immigration History Worksheet template for immigration applications');

            let shareUrl;

            switch(platform) {
                case 'linkedin':
                    shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${text}`;
                    break;
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
                    break;
                case 'whatsapp':
                    shareUrl = `https://wa.me/?text=${text}%20${url}`;
                    break;
                case 'email':
                    shareUrl = `mailto:?subject=${title}&body=${text}%20${url}`;
                    break;
            }

            if (shareUrl) {
                window.open(shareUrl, '_blank', 'width=600,height=400');
            }

            toggleShareMenu();
            return false;
        }

        function copyLink() {
            const url = window.location.href;

            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(function() {
                    // Show success message
                    const copyBtn = event.target.closest('.share-option');
                    const originalText = copyBtn.querySelector('span').textContent;
                    copyBtn.querySelector('span').textContent = 'Copied!';
                    copyBtn.style.color = '#10b981';

                    setTimeout(function() {
                        copyBtn.querySelector('span').textContent = originalText;
                        copyBtn.style.color = '';
                    }, 2000);
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Link copied to clipboard!');
            }

            return false;
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
</body>
</html>
