<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFE Response Cover Letter</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Times New Roman', Times, serif;
            line-height: 1.6;
            color: #000;
        }

        .container {
            max-width: 8.5in;
            margin: 0 auto;
            padding: 1in;
        }

        .letterhead {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #000;
        }

        .letterhead input {
            text-align: center;
            border: none;
            border-bottom: 1px dotted #666;
            font-weight: bold;
            font-size: 16px;
            margin: 3px 0;
            width: 100%;
        }

        input[type="text"], input[type="date"], textarea {
            border: none;
            border-bottom: 1px solid #666;
            padding: 5px;
            font-family: 'Times New Roman', Times, serif;
            font-size: 14px;
        }

        textarea {
            width: 100%;
            min-height: 80px;
            resize: vertical;
            border: 1px solid #ccc;
            padding: 10px;
        }

        .date-section {
            text-align: right;
            margin-bottom: 30px;
        }

        .address-block {
            margin-bottom: 30px;
        }

        .subject-line {
            font-weight: bold;
            margin: 20px 0;
        }

        .body-text p {
            text-align: justify;
            margin-bottom: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        table, th, td {
            border: 1px solid #000;
        }

        th, td {
            padding: 8px;
            text-align: left;
        }

        th {
            background: #f0f0f0;
            font-weight: bold;
        }

        .action-buttons {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .btn-action {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
        }

        .btn-action:hover {
            background: #5568d3;
            color: white;
        }

        .btn-home {
            background: #28a745;
        }

        .btn-home:hover {
            background: #218838;
        }

        @media print {
            .action-buttons, .print-hide {
                display: none !important;
            }
            body {
                margin: 0;
                padding: 0;
            }
            .container {
                max-width: 100%;
                padding: 0.5in;
            }
        }

        .critical-box {
            background: #ffebee;
            border-left: 4px solid #e74c3c;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .add-row-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* Share Menu Styles */
        .share-menu {
            position: fixed;
            top: 80px;
            right: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            z-index: 1001;
            min-width: 250px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        .share-menu.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .share-menu-header {
            padding: 16px 20px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: #1f2937;
        }

        .share-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #6b7280;
            cursor: pointer;
            padding: 0;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        .share-close:hover {
            background: #f3f4f6;
            color: #1f2937;
        }

        .share-options {
            padding: 8px;
        }

        .share-option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #374151;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.2s;
            gap: 12px;
        }

        .share-option:hover {
            background: #f3f4f6;
            color: #667eea;
        }

        .share-option i {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .share-option .fa-linkedin {
            color: #0077b5;
        }

        .share-option .fa-twitter {
            color: #1da1f2;
        }

        .share-option .fa-facebook {
            color: #1877f2;
        }

        .share-option .fa-whatsapp {
            color: #25d366;
        }

        .share-option .fa-envelope {
            color: #ea4335;
        }

        .share-option .fa-link {
            color: #6b7280;
        }

        @media print {
            .share-menu {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="action-buttons">
        <a href="/" class="btn-action btn-home">
            <i class="fas fa-home me-2"></i>Home
        </a>
        <button class="btn-action" onclick="window.print()">
            <i class="fas fa-print me-2"></i>Print
        </button>
        <button class="btn-action" onclick="window.print()">
            <i class="fas fa-file-pdf me-2"></i>Save PDF
        </button>
        <button class="btn-action" onclick="toggleShareMenu()">
            <i class="fas fa-share-alt me-2"></i>Share
        </button>
    </div>

    <!-- Share Menu -->
    <div id="shareMenu" class="share-menu">
        <div class="share-menu-header">
            <span>Share this form template</span>
            <button class="share-close" onclick="toggleShareMenu()">&times;</button>
        </div>
        <div class="share-options">
            <a href="#" class="share-option" onclick="shareOn('linkedin')">
                <i class="fab fa-linkedin"></i>
                <span>LinkedIn</span>
            </a>
            <a href="#" class="share-option" onclick="shareOn('twitter')">
                <i class="fab fa-twitter"></i>
                <span>Twitter</span>
            </a>
            <a href="#" class="share-option" onclick="shareOn('facebook')">
                <i class="fab fa-facebook"></i>
                <span>Facebook</span>
            </a>
            <a href="#" class="share-option" onclick="shareOn('whatsapp')">
                <i class="fab fa-whatsapp"></i>
                <span>WhatsApp</span>
            </a>
            <a href="#" class="share-option" onclick="shareOn('email')">
                <i class="fas fa-envelope"></i>
                <span>Email</span>
            </a>
            <a href="#" class="share-option" onclick="copyLink()">
                <i class="fas fa-link"></i>
                <span>Copy Link</span>
            </a>
        </div>
    </div>

    <div class="container">
        <div class="critical-box print-hide">
            <strong><i class="fas fa-exclamation-triangle me-2"></i>CRITICAL - TIME SENSITIVE:</strong>
            RFE responses have strict deadlines (typically 30-87 days). Submit well before the deadline with tracking.
            Address EVERY item requested. Failure to respond fully and timely may result in denial.
        </div>

        <!-- Letterhead -->
        <div class="letterhead">
            <input type="text" name="firmName" placeholder="Law Firm Name or Your Name" style="font-size: 18px;">
            <br>
            <input type="text" name="firmAddress" placeholder="Street Address">
            <br>
            <input type="text" name="firmCityState" placeholder="City, State ZIP">
            <br>
            <input type="text" name="firmContact" placeholder="Phone: (555) 123-4567 | Email: attorney@lawfirm.com">
        </div>

        <!-- Date -->
        <div class="date-section">
            <input type="date" name="date" style="border-bottom: none;">
        </div>

        <!-- USCIS Address -->
        <div class="address-block">
            <strong>U.S. Citizenship and Immigration Services</strong><br>
            <input type="text" name="uscisOffice" placeholder="USCIS Service Center" style="width: 500px;"><br>
            <input type="text" name="uscisAddress" placeholder="Address" style="width: 500px;"><br>
            <input type="text" name="uscisCityState" placeholder="City, State ZIP" style="width: 500px;">
        </div>

        <!-- Reference Line -->
        <div style="margin-bottom: 30px; font-weight: bold;">
            <strong>VIA CERTIFIED MAIL / PRIORITY MAIL</strong><br>
            <strong>TRACKING #: </strong><input type="text" name="trackingNumber" placeholder="Enter tracking number" style="width: 300px; border-bottom: 1px solid #000;">
        </div>

        <!-- Subject Line -->
        <div class="subject-line">
            RE: Response to Request for Evidence (RFE)
        </div>

        <div style="margin-left: 50px; margin-bottom: 20px;">
            <strong>Beneficiary Name:</strong> <input type="text" name="beneficiaryName" placeholder="Full Legal Name" style="width: 300px;"><br>
            <strong>Receipt Number:</strong> <input type="text" name="receiptNumber" placeholder="e.g., MSC-21-123-45678" style="width: 200px;"><br>
            <strong>A-Number:</strong> <input type="text" name="aNumber" placeholder="A-" style="width: 150px;"><br>
            <strong>Form Type:</strong> <input type="text" name="formType" placeholder="e.g., I-485, I-140" style="width: 150px;"><br>
            <strong>RFE Date:</strong> <input type="date" name="rfeDate" style="width: 150px;"><br>
            <strong>Response Deadline:</strong> <input type="date" name="deadline" style="width: 150px; border-bottom: 1px solid #e74c3c; background: #ffebee;">
        </div>

        <!-- Salutation -->
        <p style="margin-top: 30px;">
            Dear USCIS Officer:
        </p>

        <!-- Body Text -->
        <div class="body-text">
            <p>
                This letter and the accompanying documentation constitute a timely response to the Request for Evidence (RFE)
                issued on <input type="date" name="rfeDateRepeat" style="width: 150px;">
                in the above-referenced case.
            </p>

            <p>
                We have carefully reviewed the RFE and are providing the requested evidence in full. This response is organized
                to directly correspond to each item requested in the RFE.
            </p>

            <p>
                <strong>Brief Case Summary:</strong><br>
                <textarea name="caseSummary" rows="3" placeholder="Provide a brief summary of the case. Example: This is an I-140 petition for an EB-2 advanced degree professional. The beneficiary holds a Master's degree in Computer Science and has 8 years of experience as a Software Engineer."></textarea>
            </p>

            <p>
                <strong>Summary of RFE Issues:</strong><br>
                <textarea name="rfeIssues" rows="4" placeholder="Summarize what USCIS is requesting. Example: The RFE requests: (1) evidence of the beneficiary's qualifying degree, (2) evidence that the position requires an advanced degree, and (3) evidence of the petitioner's ability to pay the proffered wage."></textarea>
            </p>
        </div>

        <!-- Response to Specific RFE Items -->
        <h4 style="margin-top: 30px; margin-bottom: 15px;">RESPONSE TO SPECIFIC RFE ITEMS</h4>

        <div style="margin-bottom: 20px;">
            <p style="font-weight: bold;">
                Item 1: <input type="text" name="item1Title" placeholder="RFE Item Description" style="width: 500px; border-bottom: 1px solid #000;">
            </p>
            <p><strong>USCIS Request:</strong></p>
            <textarea name="item1Request" rows="3" placeholder="Quote or paraphrase exactly what USCIS is requesting for this item."></textarea>

            <p style="margin-top: 10px;"><strong>Our Response:</strong></p>
            <textarea name="item1Response" rows="4" placeholder="Explain how you are addressing this request. Reference specific exhibits and evidence. Be clear and direct."></textarea>
        </div>

        <div style="margin-bottom: 20px;">
            <p style="font-weight: bold;">
                Item 2: <input type="text" name="item2Title" placeholder="RFE Item Description" style="width: 500px; border-bottom: 1px solid #000;">
            </p>
            <p><strong>USCIS Request:</strong></p>
            <textarea name="item2Request" rows="3" placeholder="Quote or paraphrase the request."></textarea>

            <p style="margin-top: 10px;"><strong>Our Response:</strong></p>
            <textarea name="item2Response" rows="4" placeholder="Your detailed response."></textarea>
        </div>

        <div style="margin-bottom: 20px;">
            <p style="font-weight: bold;">
                Item 3: <input type="text" name="item3Title" placeholder="RFE Item Description" style="width: 500px; border-bottom: 1px solid #000;">
            </p>
            <p><strong>USCIS Request:</strong></p>
            <textarea name="item3Request" rows="3" placeholder="Quote or paraphrase the request."></textarea>

            <p style="margin-top: 10px;"><strong>Our Response:</strong></p>
            <textarea name="item3Response" rows="4" placeholder="Your detailed response."></textarea>
        </div>

        <!-- Evidence Index -->
        <h4 style="margin-top: 30px; margin-bottom: 15px;">INDEX OF EVIDENCE SUBMITTED</h4>

        <p style="font-size: 13px; font-style: italic; margin-bottom: 10px;">
            The following exhibits are submitted in response to the RFE:
        </p>

        <table id="evidenceTable">
            <thead>
                <tr>
                    <th style="width: 60px;">Exhibit</th>
                    <th>Document Description</th>
                    <th style="width: 120px;">Responsive To</th>
                    <th style="width: 80px;">Pages</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><input type="text" value="A" name="exhibit1"></td>
                    <td><input type="text" name="doc1" placeholder="e.g., Beneficiary's Master's Degree Diploma with Certified Translation"></td>
                    <td><input type="text" name="responsive1" placeholder="Item 1"></td>
                    <td><input type="text" name="pages1" placeholder="1-3"></td>
                </tr>
                <tr>
                    <td><input type="text" value="B" name="exhibit2"></td>
                    <td><input type="text" name="doc2" placeholder="e.g., Official Transcripts from University"></td>
                    <td><input type="text" name="responsive2" placeholder="Item 1"></td>
                    <td><input type="text" name="pages2"></td>
                </tr>
                <tr>
                    <td><input type="text" value="C" name="exhibit3"></td>
                    <td><input type="text" name="doc3" placeholder="e.g., Evaluation of Foreign Degree Credentials"></td>
                    <td><input type="text" name="responsive3" placeholder="Item 1"></td>
                    <td><input type="text" name="pages3"></td>
                </tr>
                <tr>
                    <td><input type="text" value="D" name="exhibit4"></td>
                    <td><input type="text" name="doc4" placeholder="e.g., Petitioner's 2022 Federal Tax Return"></td>
                    <td><input type="text" name="responsive4" placeholder="Item 3"></td>
                    <td><input type="text" name="pages4"></td>
                </tr>
                <tr>
                    <td><input type="text" value="E" name="exhibit5"></td>
                    <td><input type="text" name="doc5" placeholder="e.g., Petitioner's Audited Financial Statements"></td>
                    <td><input type="text" name="responsive5" placeholder="Item 3"></td>
                    <td><input type="text" name="pages5"></td>
                </tr>
            </tbody>
        </table>

        <button class="add-row-btn print-hide" onclick="addRow()">
            <i class="fas fa-plus me-2"></i>Add Another Exhibit
        </button>

        <!-- Conclusion -->
        <div style="margin-top: 40px;">
            <p>
                <strong>Conclusion:</strong><br>
                <textarea name="conclusion" rows="4" placeholder="Summarize why the evidence provided fully addresses the RFE and supports approval. Example: Based on the comprehensive evidence provided above, the beneficiary clearly meets all requirements for the requested immigration benefit. We respectfully request that USCIS approve this petition."></textarea>
            </p>

            <p style="margin-top: 20px;">
                All requested evidence and documentation is enclosed. We have organized the exhibits to correspond directly
                with each RFE item for ease of review. Please do not hesitate to contact us if any additional information is needed.
            </p>

            <p style="margin-top: 30px;">
                Respectfully submitted,
            </p>

            <div style="margin-top: 60px;">
                <p>
                    __________________________________________<br>
                    <input type="text" name="attorneyName" placeholder="Attorney Name (if applicable)" style="border: none; width: 300px;"><br>
                    <input type="text" name="attorneyBar" placeholder="Bar Number / State (if applicable)" style="border: none; width: 300px;"><br>
                    <input type="text" name="firmNameSig" placeholder="Law Firm Name or Individual Name" style="border: none; width: 300px;"><br>
                    <input type="text" name="attorneyEmail" placeholder="Email" style="border: none; width: 300px;"><br>
                    <input type="text" name="attorneyPhone" placeholder="Phone" style="border: none; width: 300px;">
                </p>
            </div>

            <div style="margin-top: 30px;">
                <p style="font-size: 12px;">
                    <strong>Enclosures:</strong> As listed above
                </p>
            </div>
        </div>

        <div style="margin-top: 40px; padding: 15px; border: 2px solid #e74c3c; background: #ffebee;">
            <p style="font-weight: bold; margin-bottom: 10px;">
                <i class="fas fa-clipboard-check me-2"></i>RFE Response Checklist (Print-Hide):
            </p>
            <ul style="font-size: 13px; margin-bottom: 0;">
                <li>✓ Responded to EVERY item in the RFE</li>
                <li>✓ Included copy of original RFE notice</li>
                <li>✓ Clearly labeled all exhibits</li>
                <li>✓ Organized evidence to match RFE items</li>
                <li>✓ Submitting before deadline with tracking</li>
                <li>✓ Kept copies of entire submission</li>
                <li>✓ Used certified or priority mail with tracking</li>
            </ul>
        </div>
    </div>

    <script>
        let exhibitCount = 5;

        function addRow() {
            exhibitCount++;
            const letter = String.fromCharCode(64 + exhibitCount);
            const table = document.getElementById('evidenceTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();

            newRow.innerHTML = `
                <td><input type="text" value="${letter}" name="exhibit${exhibitCount}"></td>
                <td><input type="text" name="doc${exhibitCount}" placeholder="Document description"></td>
                <td><input type="text" name="responsive${exhibitCount}" placeholder="Item #"></td>
                <td><input type="text" name="pages${exhibitCount}"></td>
            `;
        }

        // Auto-save functionality
        const inputs = document.querySelectorAll('input[name], textarea[name]');

        inputs.forEach(input => {
            const saved = localStorage.getItem('rfe_' + input.name);
            if (saved) input.value = saved;

            input.addEventListener('input', function() {
                localStorage.setItem('rfe_' + input.name, input.value);
            });
        });


        // Share functionality
        function toggleShareMenu() {
            const menu = document.getElementById('shareMenu');
            menu.classList.toggle('active');
        }

        // Close share menu when clicking outside
        document.addEventListener('click', function(event) {
            const menu = document.getElementById('shareMenu');
            const shareButton = event.target.closest('.btn-action');

            if (!menu.contains(event.target) && !shareButton?.textContent.includes('Share')) {
                menu.classList.remove('active');
            }
        });

        function shareOn(platform) {
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent('RFE Response Cover Letter Template');
            const text = encodeURIComponent('Check out this helpful RFE Response Cover Letter template for immigration applications');

            let shareUrl;

            switch(platform) {
                case 'linkedin':
                    shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${text}`;
                    break;
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
                    break;
                case 'whatsapp':
                    shareUrl = `https://wa.me/?text=${text}%20${url}`;
                    break;
                case 'email':
                    shareUrl = `mailto:?subject=${title}&body=${text}%20${url}`;
                    break;
            }

            if (shareUrl) {
                window.open(shareUrl, '_blank', 'width=600,height=400');
            }

            toggleShareMenu();
            return false;
        }

        function copyLink() {
            const url = window.location.href;

            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(function() {
                    // Show success message
                    const copyBtn = event.target.closest('.share-option');
                    const originalText = copyBtn.querySelector('span').textContent;
                    copyBtn.querySelector('span').textContent = 'Copied!';
                    copyBtn.style.color = '#10b981';

                    setTimeout(function() {
                        copyBtn.querySelector('span').textContent = originalText;
                        copyBtn.style.color = '';
                    }, 2000);
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Link copied to clipboard!');
            }

            return false;
        }
    </script>
</body>
</html>
